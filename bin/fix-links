#!/usr/bin/env zsh
#
# This adjusts the file paths for the linked content generated by
# quarto. This only seems to affect knitr, the julia engine inlines
# svg.
###

setopt err_return

if [[ ! -d $1 ]]; then
  print -u 2 "Usage: fix-links <directory>"
  exit 1
fi

for i in $1/*.html; do
    print "Adjusting file paths for $i"
    sed -i -r -e "s/src=\"(${i:t:r}_files)/src=\"\.\.\/assets\/\1/" $i
done
